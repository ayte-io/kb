<header role="banner">
    {%- assign default_paths = site.pages | where_exp: 'cursor', 'cursor.dir == page.dir' | where_exp: 'cursor', 'cursor.name != page.name' | map: "path" -%}
    {%- assign page_paths = site.header_pages | default: default_paths -%}

      <nav class="blue lighten-1">
        <div class="nav-wrapper">
        <div class="container">
        <div class="kb-nav-container">
        <a class="white-text brand-logo waves-effect waves-light" href="{{ '/' | relative_url }}">{{ site.title | escape }}</a>

        <ul class="kb-nav-links">
          {%- assign aggregate_path = '' -%}
          {%- assign segments = page.dir | split: '/' | where_exp: 'segment', 'segment != ""' -%}
          {%- for segment in segments -%}
            {%- assign aggregate_path = aggregate_path | append: segment | append: '/' -%}
            {%- assign page_path = aggregate_path | append: 'index.md' -%}
            {%- assign cursor = site.pages | where: 'path', page_path | first -%}
            {%- if cursor and cursor.title -%}
              <li>
              <a class="waves-effect waves-light" href="{{ cursor.url | relative_url }}">/ {{ cursor.title | escape }}</a>
              </li>
            {%- endif -%}
          {%- endfor -%}
          {%- unless page.path contains 'index.md' -%}
            <li>
              <a class="waves-effect waves-light" href="{{ page.url | relative_url }}">/ {{ page.title | escape }}</a>
            </li>
          {%- endunless -%}
        </ul>
        </div>
        </div>
        </div>
      </nav>
</header>
